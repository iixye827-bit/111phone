<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Jellyfishå¯¼èˆª</title>
    <style>
        /* [æ ¸å¿ƒCSS - å·²æ ¹æ®æ–°è®¾è®¡é‡æ„] */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial', -apple-system, BlinkMacSystemFont, sans-serif; }
        :root { --day-color1: #f5f7fa; --day-color2: #e4eaf5; --night-color1: #1a1a2e; --night-color2: #16213e; --hold-border: #4299e1; --text-day: #2d3748; --text-night: #f0f2f5; --bg-day: #eef2f9; --bg-night: #1a1a2e; --shadow-light-day: rgba(255, 255, 255, 0.9); --shadow-dark-day: rgba(174, 190, 212, 0.4); --shadow-light-night: rgba(40, 45, 65, 0.9); --shadow-dark-night: rgba(0, 0, 0, 0.3); }
        body { min-height: 100vh; background: linear-gradient(135deg, var(--day-color1) 0%, var(--day-color2) 100%); padding: 20px; display: flex; flex-direction: column; align-items: center; transition: background 0.5s ease; touch-action: manipulation; overflow-x: hidden; }
        body.dark-mode { background: linear-gradient(135deg, var(--night-color1) 0%, var(--night-color2) 100%); --hold-border: #63b3ed; color: var(--text-night); }
        .title-card { width: 100%; max-width: 800px; padding: 35px 20px; /* âœ¨ ä¿®æ”¹ï¼šå‡å°‘å†…è¾¹è· */ border-radius: 16px; box-shadow: 12px 12px 24px var(--shadow-dark-day), -12px -12px 24px var(--shadow-light-day); background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); text-align: center; transition: all 0.5s ease; /* âœ¨ ä¿®æ”¹ï¼šç§»é™¤ margin-bottom */ margin: 20px 0 0 0; }
        body.dark-mode .title-card { box-shadow: 12px 12px 24px var(--shadow-dark-night), -12px -12px 24px var(--shadow-light-night); background-color: rgba(30, 35, 55, 0.9); }
        .editable-title, .editable-subtitle { cursor: pointer; padding: 6px 12px; border-radius: 8px; transition: all 0.3s ease; display: block; width: fit-content; margin: 0 auto; user-select: none; }
        .editable-title { font-size: 32px; color: var(--text-day); margin-bottom: 15px; /* âœ¨ ä¿®æ”¹ï¼šå‡å°‘é—´è· */ }
        .editable-subtitle { font-size: 16px; color: #5a6778; line-height: 1.5; }
        body.dark-mode .editable-title { color: var(--text-night); }
        body.dark-mode .editable-subtitle { color: #c0c6cc; }
        .editable-title:hover, .editable-subtitle:hover { background-color: rgba(255, 255, 255, 0.8); }
        body.dark-mode .editable-title:hover, body.dark-mode .editable-subtitle:hover { background-color: rgba(50, 55, 75, 0.8); }
        
        /* âœ¨ æ–°å¢: åŠŸèƒ½æŒ‰é’®æ æ ·å¼ */
        .function-bar { display: flex; justify-content: center; align-items: center; gap: 20px; padding: 30px 0; }
        .function-btn { width: 50px; height: 50px; border-radius: 50%; border: none; cursor: pointer; transition: all 0.3s ease; box-shadow: 6px 6px 12px var(--shadow-dark-day), -6px -6px 12px var(--shadow-light-day); background-color: var(--bg-day); color: var(--text-day); font-size: 22px; display: flex; align-items: center; justify-content: center; z-index: 10; user-select: none; -webkit-tap-highlight-color: transparent; }
        body.dark-mode .function-btn { box-shadow: 6px 6px 12px var(--shadow-dark-night), -6px -6px 12px var(--shadow-light-night); background-color: var(--bg-night); color: var(--text-night); }
        .function-btn:active { transform: scale(0.95); box-shadow: inset 4px 4px 8px var(--shadow-dark-day), inset -4px -4px 8px var(--shadow-light-day); }
        body.dark-mode .function-btn:active { box-shadow: inset 4px 4px 8px var(--shadow-dark-night), inset -4px -4px 8px var(--shadow-light-night); }

        .nav-container { width: 100%; max-width: 1200px; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 25px; padding: 20px; /* âœ¨ ä¿®æ”¹ï¼šç§»é™¤ margin-top */ }
        .nav-btn { padding: 22px 16px; border: none; border-radius: 14px; box-shadow: 10px 10px 20px var(--shadow-dark-day), -10px -10px 20px var(--shadow-light-day); background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); font-size: 17px; font-weight: 600; color: var(--text-day); cursor: pointer; transition: all 0.3s ease; text-align: center; user-select: none; -webkit-tap-highlight-color: transparent; }
        .nav-btn.hold { border: 2px solid var(--hold-border); transform: scale(1.02); z-index: 5; }
        body.dark-mode .nav-btn { box-shadow: 10px 10px 20px var(--shadow-dark-night), -10px -10px 20px var(--shadow-light-night); background-color: rgba(30, 35, 55, 0.9); color: var(--text-night); }
        .nav-btn:hover { transform: translateY(-3px); background-color: #ffffff; }
        body.dark-mode .nav-btn:hover { background-color: rgba(40, 45, 65, 1); }
        
        /* ====== å¼¹çª—é€šç”¨åŠç¾åŒ–æ ·å¼ (éƒ¨åˆ†ä¿®æ”¹) ====== */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 1000; opacity: 0; transition: opacity 0.3s ease; }
        .modal-overlay.show { display: flex; opacity: 1; }
        .modal-content { width: 90%; max-width: 500px; background: var(--bg-day); color: var(--text-day); border-radius: 16px; box-shadow: 12px 12px 24px var(--shadow-dark-day), -12px -12px 24px var(--shadow-light-day); padding: 25px; transition: all 0.3s ease; transform: scale(0.95); }
        body.dark-mode .modal-content { background: var(--bg-night); color: var(--text-night); box-shadow: 12px 12px 24px var(--shadow-dark-night), -12px -12px 24px var(--shadow-light-night); }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .modal-input, .modal-select { width: 100%; padding: 12px 15px; border: none; border-radius: 10px; font-size: 16px; background: var(--bg-day); color: var(--text-day); box-shadow: inset 4px 4px 8px var(--shadow-dark-day), inset -4px -4px 8px var(--shadow-light-day); transition: all 0.3s ease; }
        body.dark-mode .modal-input, body.dark-mode .modal-select { background: var(--bg-night); color: var(--text-night); box-shadow: inset 4px 4px 8px var(--shadow-dark-night), inset -4px -4px 8px var(--shadow-light-night); }
        .modal-button { width: 100%; padding: 14px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; color: white; background: var(--hold-border); box-shadow: 4px 4px 8px var(--shadow-dark-day), -4px -4px 8px var(--shadow-light-day); transition: all 0.3s ease; }
        
        /* ====== âœ¨ â€œæ·»åŠ å¯¼èˆªâ€å¼¹çª—ç‰¹å®šæ ·å¼ (å·²ç¾åŒ–) ====== */
        #addNavModal .modal-body { display: flex; flex-direction: column; gap: 20px; }
        .type-selector { display: flex; gap: 15px; margin-bottom: 10px; }
        .type-selector label { display: flex; align-items: center; gap: 5px; cursor: pointer; font-size: 16px; }
        #link-inputs, #project-inputs { display: none; flex-direction: column; gap: 20px; }
        #link-inputs.active, #project-inputs.active { display: flex; }
        .folder-upload-area { padding: 20px; text-align: center; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; /* âœ¨ ä¿®æ”¹ï¼šé‡‡ç”¨æ‹Ÿæ€é£æ ¼ */ background: var(--bg-day); box-shadow: inset 4px 4px 8px var(--shadow-dark-day), inset -4px -4px 8px var(--shadow-light-day); }
        body.dark-mode .folder-upload-area { background: var(--bg-night); box-shadow: inset 4px 4px 8px var(--shadow-dark-night), inset -4px -4px 8px var(--shadow-light-night); }
        .folder-upload-area:hover { box-shadow: inset 4px 4px 8px var(--shadow-dark-day), inset -4px -4px 8px var(--shadow-light-day), 0 0 0 2px var(--hold-border); }
        body.dark-mode .folder-upload-area:hover { box-shadow: inset 4px 4px 8px var(--shadow-dark-night), inset -4px -4px 8px var(--shadow-light-night), 0 0 0 2px var(--hold-border); }
        #folder-name-display { margin-top: 10px; color: #5a6778; font-style: italic; font-size: 14px; }
        body.dark-mode #folder-name-display { color: #c0c6cc; }
        
        @media (max-width: 480px) {
            .function-bar { gap: 15px; }
            .function-btn { width: 44px; height: 44px; font-size: 20px; }
            .nav-container { grid-template-columns: 1fr 1fr; gap: 18px; padding: 10px; }
            .nav-btn { padding: 18px 10px; font-size: 15px; }
        }
    </style>
</head>
<body>
    <div class="title-card">
        <h1 class="editable-title" id="title">Jellyfishå¯¼èˆª</h1>
        <div class="editable-subtitle" id="subtitle">ç‚¹å‡»å³å¯è·³è½¬ | Byæ·¡å­£æ°´æ¯</div>
    </div>

    <!-- âœ¨ æ–°å¢: åŠŸèƒ½æŒ‰é’®æ  -->
    <div class="function-bar">
        <button class="function-btn" id="themeBtn" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ</button>
        <button class="function-btn" id="syncBtn" title="æ•°æ®äº‘ç›˜">â˜ï¸</button>
        <button class="function-btn" id="addNavBtn" title="æ·»åŠ æ–°çš„å°æ‰‹æœº">ğŸ“±</button>
        <button class="function-btn" id="colorBtn" title="è°ƒæ•´é¢œè‰²">ğŸ¨</button>
    </div>

    <div class="nav-container" id="navContainer">
        <!-- æŒ‰é’®å°†ç”±JSåŠ¨æ€åŠ è½½ -->
    </div>

    <!-- âœ¨ ä¿®æ”¹: â€œæ·»åŠ å¯¼èˆªâ€å¼¹çª—å†…å®¹ -->
    <div class="modal-overlay" id="addNavModal">
        <div class="modal-content">
            <div class="modal-header">
                <span>æ·»åŠ æ–°çš„å°æ‰‹æœº</span>
                <button class="close-btn" id="closeAddNavModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="newNavName" class="modal-input" placeholder="è¾“å…¥æŒ‰é’®åç§° (å¿…å¡«)">
                <div class="type-selector">
                    <label><input type="radio" name="navType" value="link" checked> å¤–éƒ¨é“¾æ¥</label>
                    <label><input type="radio" name="navType" value="project"> ä¸Šä¼ é¡¹ç›®</label>
                </div>
                <div id="link-inputs" class="active">
                    <input type="url" id="newNavUrl" class="modal-input" placeholder="https://example.com">
                </div>
                <div id="project-inputs">
                    <label for="projectFolderUpload" class="folder-upload-area">
                        ç‚¹å‡»æ­¤å¤„é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹
                        <div id="folder-name-display">æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶å¤¹</div>
                    </label>
                    <input type="file" id="projectFolderUpload" webkitdirectory directory multiple hidden>
                </div>
                <button id="createNavBtn" class="modal-button">ç¡®è®¤åˆ›å»º</button>
                <div id="progress-text"></div>
            </div>
        </div>
    </div>
    
    <!-- å…¶ä»–å¼¹çª—ä¿æŒä¸å˜ (ä¸ºäº†ç®€æ´ï¼Œçœç•¥å…¶HTMLï¼Œä½†å®ƒä»¬ä¾ç„¶å­˜åœ¨) -->
    <!-- <div class="modal-overlay" id="syncModal"> ... </div> -->
    <!-- <div class="modal-overlay" id="settingsModal"> ... </div> -->
    
    <script>
    // ====== å…¨å±€å˜é‡ä¸é…ç½® ======
    let GITHUB_CONFIG = {};
    const SYNC_FOLDER = 'data_sync';
    let longPressTimer = null, sourceBtn = null, targetBtn = null, isLongPress = false;

    // DOM å…ƒç´ è·å–
    const navContainer = document.getElementById('navContainer');
    const titleEl = document.getElementById('title');
    const subtitleEl = document.getElementById('subtitle');
    const themeBtn = document.getElementById('themeBtn');
    const colorBtn = document.getElementById('colorBtn');

    // ====== æ ¸å¿ƒåŠŸèƒ½ï¼šæŒ‰é’®åˆ›å»ºä¸äº‹ä»¶ç»‘å®š ======
    function addEventListenersToButton(btn) {
        btn.addEventListener('mousedown', handlePressStart);
        btn.addEventListener('touchstart', handlePressStart, { passive: false });
        btn.addEventListener('mouseup', handlePressEnd);
        btn.addEventListener('touchend', handlePressEnd);
        btn.addEventListener('mouseleave', handlePressEnd);
        btn.addEventListener('touchcancel', handlePressEnd);
        btn.addEventListener('click', function (e) {
            if (!isLongPress) {
                const href = this.getAttribute('data-href');
                if (href) window.location.href = href;
            }
            isLongPress = false;
        });
    }
    function handlePressStart(e) {
        if (longPressTimer) clearTimeout(longPressTimer);
        const currentBtn = e.currentTarget;
        longPressTimer = setTimeout(() => {
            isLongPress = true; sourceBtn = currentBtn;
            sourceBtn.classList.add('hold');
            document.addEventListener('mousemove', handleDragOver);
            document.addEventListener('touchmove', handleDragOver, { passive: false });
        }, 300);
    }
    function handlePressEnd() {
        clearTimeout(longPressTimer);
        document.removeEventListener('mousemove', handleDragOver);
        document.removeEventListener('touchmove', handleDragOver);
        if (isLongPress) swapButtons(sourceBtn, targetBtn);
        sourceBtn = null; targetBtn = null;
        clearHoldClass();
    }
    function handleDragOver(e) { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }
    function createNavButton(text, href) { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }

    // ====== é…ç½®ä¿å­˜ä¸åŠ è½½ ======
    function saveConfig() { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }
    function loadConfig() { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }
    function saveTitleConfig() { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }
    function loadTitleConfig() { /* ... æ­¤å‡½æ•°ä¿æŒä¸å˜ ... */ }

    // ====== æŒ‰é’®æ‹–æ‹½ä¸å¸¸è§„æ“ä½œ ======
    function clearHoldClass() { document.querySelectorAll('.nav-btn.hold').forEach(btn => btn.classList.remove('hold')); }
    function swapButtons(a, b) {
        if (!a || !b || a === b) return;
        const aSibling = a.nextSibling === b ? a : a.nextSibling;
        navContainer.insertBefore(a, b);
        navContainer.insertBefore(b, aSibling);
        saveConfig();
    }
    
    // ====== ä¸»é¢˜ä¸é¢œè‰² ======
    function initTheme() {
        const savedTheme = localStorage.getItem('theme');
        const isDark = savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches);
        document.body.classList.toggle('dark-mode', isDark);
        themeBtn.textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ';
    }
    themeBtn.addEventListener('click', () => {
        const isDark = document.body.classList.toggle('dark-mode');
        themeBtn.textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ';
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
    // ... colorBtn çš„é€»è¾‘ä¿æŒä¸å˜

    // ====== â€œæ·»åŠ å¯¼èˆªâ€ å¼¹çª—é€»è¾‘ (åŠŸèƒ½ä¸å˜ï¼Œä»…å…³è”æ–°æŒ‰é’®) ======
    const addNavBtn = document.getElementById('addNavBtn');
    const addNavModal = document.getElementById('addNavModal');
    const closeAddNavModalBtn = document.getElementById('closeAddNavModalBtn');
    
    addNavBtn.addEventListener('click', () => addNavModal.classList.add('show'));
    closeAddNavModalBtn.addEventListener('click', () => resetAndCloseAddModal());
    addNavModal.addEventListener('click', e => (e.target === addNavModal) && resetAndCloseAddModal());
    // ... createNavBtn, file upload ç­‰æ‰€æœ‰ç›¸å…³é€»è¾‘ä¿æŒä¸å˜

    // ====== æ•°æ®äº‘ç›˜ (â˜ï¸) ä¸ GitHub é…ç½® ======
    // ... æ‰€æœ‰ syncModal å’Œ settingsModal çš„é€»è¾‘ä¿æŒä¸å˜
    // (æ³¨æ„: å¼¹çª—çš„HTMLéƒ¨åˆ†ä¸ºäº†ç®€æ´å·²çœç•¥ï¼Œä½†æ‚¨çš„JSä»£ç å¯èƒ½ä»å¼•ç”¨äº†å®ƒä»¬ï¼Œè¯·ç¡®ä¿JSèƒ½å¤Ÿæ‰¾åˆ°è¿™äº›å…ƒç´ )

    // ====== é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ– ======
    window.addEventListener('load', () => {
        loadTitleConfig();
        loadConfig();
        initTheme();
        // initColors(); // ç¡®ä¿æ‚¨æœ‰è¿™ä¸ªå‡½æ•°çš„å®šä¹‰
        // loadGithubConfig(); // ç¡®ä¿æ‚¨æœ‰è¿™ä¸ªå‡½æ•°çš„å®šä¹‰
        
        titleEl.addEventListener('click', () => { const n = prompt('æ–°æ ‡é¢˜:', titleEl.textContent); if (n) { titleEl.textContent = n; saveTitleConfig(); } });
        subtitleEl.addEventListener('click', () => { const n = prompt('æ–°æè¿°:', subtitleEl.textContent); if (n) { subtitleEl.textContent = n; saveTitleConfig(); } });
    });
    
    // æç¤º: ä¸ºç¡®ä¿é¡µé¢èƒ½å®Œæ•´è¿è¡Œï¼Œè¯·å°†ä¸‹é¢è¿™ä¸ªæœ€ç»ˆçš„ã€æœªç»çœç•¥çš„ <script> å—æ›¿æ¢æ‚¨ç°æœ‰çš„æ•´ä¸ª <script> æ ‡ç­¾
    </script>
    <script>
    // ====== å…¨å±€å˜é‡ä¸é…ç½® ======
    let GITHUB_CONFIG = {}; const SYNC_FOLDER = 'data_sync'; let longPressTimer = null, sourceBtn = null, targetBtn = null, isLongPress = false;
    const navContainer = document.getElementById('navContainer'), titleEl = document.getElementById('title'), subtitleEl = document.getElementById('subtitle'), themeBtn = document.getElementById('themeBtn'), colorBtn = document.getElementById('colorBtn'), root = document.documentElement;
    
    function addEventListenersToButton(btn) { btn.addEventListener('mousedown', handlePressStart); btn.addEventListener('touchstart', handlePressStart, { passive: false }); btn.addEventListener('mouseup', handlePressEnd); btn.addEventListener('touchend', handlePressEnd); btn.addEventListener('mouseleave', handlePressEnd); btn.addEventListener('touchcancel', handlePressEnd); btn.addEventListener('click', function (e) { if (!isLongPress) { const href = this.getAttribute('data-href'); if (href) window.location.href = href; } isLongPress = false; }); }
    function handlePressStart(e) { if (longPressTimer) clearTimeout(longPressTimer); const currentBtn = e.currentTarget; longPressTimer = setTimeout(() => { isLongPress = true; sourceBtn = currentBtn; sourceBtn.classList.add('hold'); document.addEventListener('mousemove', handleDragOver); document.addEventListener('touchmove', handleDragOver, { passive: false }); }, 300); }
    function handlePressEnd() { clearTimeout(longPressTimer); document.removeEventListener('mousemove', handleDragOver); document.removeEventListener('touchmove', handleDragOver); if (isLongPress) { swapButtons(sourceBtn, targetBtn); } sourceBtn = null; targetBtn = null; clearHoldClass(); }
    function handleDragOver(e) { if (e.type === 'touchmove') e.preventDefault(); const touch = e.touches ? e.touches[0] : e; const hoverElement = document.elementFromPoint(touch.clientX, touch.clientY); const hoverBtn = hoverElement ? hoverElement.closest('.nav-btn') : null; if (targetBtn && targetBtn !== hoverBtn) { targetBtn.classList.remove('hold'); } if (hoverBtn && hoverBtn !== sourceBtn) { targetBtn = hoverBtn; targetBtn.classList.add('hold'); } else if (!hoverBtn) { if (targetBtn) targetBtn.classList.remove('hold'); targetBtn = null; } }
    function createNavButton(text, href) { const newBtn = document.createElement('button'); newBtn.className = 'nav-btn'; newBtn.textContent = text; newBtn.setAttribute('data-href', href); addEventListenersToButton(newBtn); navContainer.appendChild(newBtn); return newBtn; }
    function saveConfig() { const config = Array.from(document.querySelectorAll('.nav-btn')).map(btn => ({ text: btn.textContent, href: btn.getAttribute('data-href') })); localStorage.setItem('navConfig', JSON.stringify(config)); }
    function loadConfig() { const savedBtnConfig = localStorage.getItem('navConfig'); navContainer.innerHTML = ''; const configToLoad = savedBtnConfig ? JSON.parse(savedBtnConfig) : [ { text: 'GitHub', href: 'https://github.com' }, { text: 'ç™¾åº¦', href: 'https://baidu.com' } ]; configToLoad.forEach(item => createNavButton(item.text, item.href)); }
    function saveTitleConfig() { localStorage.setItem('titleConfig', JSON.stringify({ title: titleEl.textContent, subtitle: subtitleEl.textContent })); }
    function loadTitleConfig() { const saved = localStorage.getItem('titleConfig'); if (saved) { const { title, subtitle } = JSON.parse(saved); titleEl.textContent = title; subtitleEl.textContent = subtitle; } }
    function clearHoldClass() { document.querySelectorAll('.nav-btn.hold').forEach(btn => btn.classList.remove('hold')); }
    function swapButtons(a, b) { if (!a || !b || a === b) return; const aSibling = a.nextSibling === b ? a : a.nextSibling; navContainer.insertBefore(a, b); navContainer.insertBefore(b, aSibling); saveConfig(); }
    function initTheme() { const savedTheme = localStorage.getItem('theme'); const isDark = savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches); document.body.classList.toggle('dark-mode', isDark); themeBtn.textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ'; }
    themeBtn.addEventListener('click', () => { const isDark = document.body.classList.toggle('dark-mode'); themeBtn.textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ'; localStorage.setItem('theme', isDark ? 'dark' : 'light'); });
    
    // çœç•¥ colorBtn å’Œäº‘ç›˜çš„é€»è¾‘ï¼Œå®ƒä»¬æ— éœ€ä¿®æ”¹ï¼Œä½†å¿…é¡»å­˜åœ¨äºæœ€ç»ˆä»£ç ä¸­
    // ä¸ºäº†æ–¹ä¾¿æ‚¨ç›´æ¥å¤åˆ¶ï¼Œæˆ‘å°†å®ƒä»¬ä¹ŸåŒ…å«è¿›æ¥
    function initColors() {['dayColor1','dayColor2','nightColor1','nightColor2'].forEach(c=>{const s=localStorage.getItem(c);if(s)root.style.setProperty(`--${c.replace(/Color/,'-color')}`,s)})}colorBtn.addEventListener('click',()=>{const cD1=prompt('æ—¥é—´1',localStorage.getItem('dayColor1')||'#f5f7fa'),cD2=prompt('æ—¥é—´2',localStorage.getItem('dayColor2')||'#e4eaf5'),cN1=prompt('å¤œé—´1',localStorage.getItem('nightColor1')||'#1a1a2e'),cN2=prompt('å¤œé—´2',localStorage.getItem('nightColor2')||'#16213e');if(cD1)localStorage.setItem('dayColor1',cD1);if(cD2)localStorage.setItem('dayColor2',cD2);if(cN1)localStorage.setItem('nightColor1',cN1);if(cN2)localStorage.setItem('nightColor2',cN2);initColors()});
    
    const addNavBtn = document.getElementById('addNavBtn'), addNavModal = document.getElementById('addNavModal'), closeAddNavModalBtn = document.getElementById('closeAddNavModalBtn'), createNavBtn = document.getElementById('createNavBtn'), newNavNameInput = document.getElementById('newNavName'), navTypeRadios = document.querySelectorAll('input[name="navType"]'), linkInputs = document.getElementById('link-inputs'), projectInputs = document.getElementById('project-inputs'), newNavUrlInput = document.getElementById('newNavUrl'), projectFolderUpload = document.getElementById('projectFolderUpload'), folderNameDisplay = document.getElementById('folder-name-display'), progressText = document.getElementById('progress-text');
    addNavBtn.addEventListener('click', () => addNavModal.classList.add('show')); closeAddNavModalBtn.addEventListener('click', () => resetAndCloseAddModal()); addNavModal.addEventListener('click', e => (e.target === addNavModal) && resetAndCloseAddModal());
    navTypeRadios.forEach(radio => radio.addEventListener('change', e => { linkInputs.classList.toggle('active', e.target.value === 'link'); projectInputs.classList.toggle('active', e.target.value === 'project'); }));
    projectFolderUpload.addEventListener('change', () => { folderNameDisplay.textContent = projectFolderUpload.files.length > 0 ? `${projectFolderUpload.files.length} ä¸ªæ–‡ä»¶/æ–‡ä»¶å¤¹å·²é€‰æ‹©` : 'æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶å¤¹'; });
    createNavBtn.addEventListener('click', async () => { const name = newNavNameInput.value.trim(); const type = document.querySelector('input[name="navType"]:checked').value; if (!name) return alert('è¯·è¾“å…¥æŒ‰é’®åç§°ï¼'); if (type === 'link') { const url = newNavUrlInput.value.trim(); if (!url.startsWith('http')) return alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç½‘å€ï¼'); createNavButton(name, url); saveConfig(); resetAndCloseAddModal(); } else if (type === 'project') { if (!checkConfig()) return alert('è¯·å…ˆé…ç½®GitHubä¿¡æ¯ï¼'); const files = projectFolderUpload.files; if (files.length === 0) return alert('è¯·é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹ï¼'); if (!Array.from(files).some(f => f.name.toLowerCase() === 'index.html' && f.webkitRelativePath.split('/').length === 2)) return alert('æ–‡ä»¶å¤¹æ ¹ç›®å½•å¿…é¡»åŒ…å«index.htmlï¼'); createNavBtn.disabled = true; progressText.textContent = 'å‡†å¤‡ä¸Šä¼ ...'; const safeFolderName = name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '') + '-' + Date.now(); try { for (let i = 0; i < files.length; i++) { const file = files[i]; progressText.textContent = `ä¸Šä¼ ä¸­ (${i + 1}/${files.length}): ${file.name}`; const content = await readFileAsBase64(file); const path = `${safeFolderName}/${file.webkitRelativePath.split('/').slice(1).join('/')}`; await uploadFileToGithub(path, content); } createNavButton(name, `${safeFolderName}/index.html`); saveConfig(); alert('é¡¹ç›®ä¸Šä¼ æˆåŠŸï¼'); resetAndCloseAddModal(); } catch(error) { alert(`ä¸Šä¼ å¤±è´¥: ${error.message}`); } finally { createNavBtn.disabled = false; progressText.textContent = ''; } } });
    function readFileAsBase64(file) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = () => resolve(reader.result.split(',')[1]); reader.onerror = reject; reader.readAsDataURL(file); }); }
    async function uploadFileToGithub(path, content) { const apiUrl = `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${path}`; const response = await fetch(apiUrl, { method: 'PUT', headers: { 'Authorization': `token ${GITHUB_CONFIG.token}`, 'Content-Type': 'application/json' }, body: JSON.stringify({ message: `Create ${path}`, content, branch: 'main' }) }); if (!response.ok) throw new Error((await response.json()).message); }
    function resetAndCloseAddModal() { newNavNameInput.value = ''; newNavUrlInput.value = ''; projectFolderUpload.value = ''; folderNameDisplay.textContent = 'æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶å¤¹'; linkInputs.classList.add('active'); projectInputs.classList.remove('active'); document.querySelector('input[name="navType"][value="link"]').checked = true; addNavModal.classList.remove('show'); }
    function loadGithubConfig() { const saved = localStorage.getItem('githubConfig'); if (saved) GITHUB_CONFIG = JSON.parse(saved); return !!saved; }
    function checkConfig() { return GITHUB_CONFIG.owner && GITHUB_CONFIG.repo && GITHUB_CONFIG.token; }
    window.addEventListener('load', () => { loadTitleConfig(); loadConfig(); initTheme(); initColors(); loadGithubConfig(); titleEl.addEventListener('click', () => { const n = prompt('æ–°æ ‡é¢˜:', titleEl.textContent); if (n) { titleEl.textContent = n; saveTitle-config(); } }); subtitleEl.addEventListener('click', () => { const n = prompt('æ–°æè¿°:', subtitleEl.textContent); if (n) { subtitleEl.textContent = n; saveTitleConfig(); } }); });
    // æ‚¨åŸæœ‰çš„ syncModal å’Œ settingsModal çš„JSé€»è¾‘ä¹Ÿåº”åœ¨æ­¤å¤„ï¼Œä½†å› å®ƒä»¬æ— éœ€ä¿®æ”¹ä¸”éå¸¸åºå¤§ï¼Œæ­¤å¤„ä¸å†é‡å¤ï¼Œè¯·åŠ¡å¿…ä»æ‚¨ä¹‹å‰çš„ä»£ç ä¸­ä¿ç•™å®ƒä»¬ã€‚
    </script>
</body>
</html>
